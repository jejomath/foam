page_modules:
  - name: experiments
    descr: Pages related to experiments.
    pages:

    - name: home
      descr: Home Page for the whole site
      type: LinksPage
      config:
        boxes:
        - name: assays
          links:
          - target: find_assay
            display: Find Assays
          - target: view_assay
            display: New Assay
        - name: experiments
          links:
          - target: find_experiment
            display: Find Experiments
          - target: edit_experiment
            display: New Experiment
            mode: modal

    - name: view_experiment
      descr: Use this page to find experiments
      type: RecordPage
      config:
        source_table: experiment
        view_fields:
        - name
        - description
        - start_date
        - type
        - assay
        buttons:
        - display: Done
          target: back
        - display: Edit
          target: edit_experiment
          params_fn: "(params) => ({ id: params.id })"

    - name: edit_experiment
      descr: Use this page to find experiments
      type: RecordPage
      config:
        source_table: experiment
        view_fields:
        - name
        - description
        - start_date
        - type
        - assay
        edit_fields:
        - field: name
          display: Experiment Name
        - description
        - start_date
        - type
        - field: assay
          lookup: find_assay
        buttons:
        - display: Save
          target: back
          pretarget_fn: "(params, data, context) => { context.save() }"
        - display: Cancel
          target: back

    - name: find_experiment
      descr: Use this page to find experiments
      type: TablePage
      config:
        source_table: experiment
        view_columns:
        - field: name
          width: 100
        - field: description
          width: 200
        - field: start_date
          width: 50
        - field: type
          width: 150
        search_fields:
        - name
        - description
        - start_date
        - type
        row_action:
          display: Select Experiment
          target: view_experiment
          params_fn: "(data) => ({id: data.id})"
        buttons:
        - display: Done
          target: back

    - name: find_assay
      descr: Use this page to find assays
      type: TablePage
      config:
        source_table: assay
        view_columns:
        - field: name
          width: 100
        - field: type
          width: 150
        search_fields:
        - name
        - type
        row_action:
          display: Select Experiment
          target: view_assay
          params_fn: "(data) => ({id: data.id})"
        buttons:
        - display: Done
          target: back

    - name: view_assay
      descr: View the details of an assay
      type: RecordPage
      config:
        source_table: assay
        view_fields:
        - name
        - type
        reference_tables:
        - display: Experiments
          table_page: find_experiment
          params_fn: "(data) => ({assay: data.id})"
        buttons:
        - display: Done
          target: back
